# Simulation-of-Adhoc-protocols
Mobile Adhoc Networks (MANET) is decentralized network that is formed by wireless hosts without a pre-existing infrastructure. Mobile adhoc networks are easy to deploy and dont depend on any existing infrastructure. Each node participates in routing by forwarding data for other nodes, so the determination of which nodes forward data is made dynamically on the basis of network connectivity and the routing algorithm in use. Routes between nodes may potentially contain multiple hops and may need to traverse multiple links to reach a destination.
There are different types of adhoc routing protocols. This repository contains an python implementation of 
1. Flooding
2. Dynamic Source Routing.

## Required Libraries
The following is the list of required python libraries used in this implementation:

- pickle
- networkx
- matplotlib
- socket
- time
- thread

## Brief Explanation of protocols

### Flooding
In this protocol, a node S sends a packet P to node D. Each neighbor recieves the packet and checks if it has recieved the packet before, if the packet hasnt been recieved before the node broadcasts it to all other neighbors else it drops the packet. When the destination node recieves the packet it doesnot forward it further. Due to broadcasting, all nodes may recieve the packets in the worst case ie high packet overhead. The protocol is used when there are frequent topology changes and infrequent packet transmissions.
#### File graphgenerator.py
This file generates a connected graph of nodes and stores it in a pickle file. The no of nodes in the graph can be changed using by changing variable n's value at Line 14. 
#### File mainnode.py
This file runs two threads. startprocesses threads runs the nodes.py file and the number of nodes generated is equal to the number of nodes generated by the graphgenerator file( spawns n command line processes acting as nodes for the simulation of). The no of nodes in the graph can be changed using by changing variable n's value at Line 14. The server thread is for listening to the operations the functions each client is performing that'd provide us a central view of whats going on. Note: The server thread only recieves from the node the information about the functions they perform to provide a central view (nodes in no way depend upon the server). The server listen to at port 9000.
For the concept of mobility, inputing 1 will change the connections of 1-15% nodes 40% edges(remove 40% edges and add 40% edges).
The graph stored in the pickle file contains all the edges so that each node can know its neighbors.
#### File nodes.py
The nodes.py file is run by the mainnode.py. Each node runs 2 threads. One that takes packket inputs from command line and sends to the destination and other thread handles the packets recieved from neighbor nodes. A nodes port no is simply calculated as (10000+id).

### Dynamic Source Routing
This is a reactive protocols in which flooding is used for establishing routes. When a node wants to send a packet to the destination, it checks whether it knows the route to the destination, if it doesnt , then a route discovery(rreq) packet is generated (Concepts of flooding apply) and broadcasted. The destination node on recieveing the packet sends a Route reply(rrep) packet along the path backwards to which it was recieved (each node reciveing rreq packets append itself to the path and broadcasts it ie rreq packets contain the paths the followed). When the sender S recieves the rrep packet it stores the route and sends the data packet to the destination along the path it recieved in rrep packet. When forwarding the data packet with route SEFJD and J-D fails then J sends a route error RERR[J-D] to S along route J-F-E-S and Nodes hearing RERR update their route cache to remove link J-D

Route Optimizations
- Node S finds route [S,E,F,J,D] to node D then it also learns route [S,E,F,J] to J.
- Node E receives RREQ [S,C,G] then it learns route [E,G,C,S] to S (assuming bi-directional links).
- Node F receives RREP [S,E,F,J,D] then it learns route [F,J,D] to D.
- Node G forwards Data [S,G,F,J,D] then it learns route [G,F,J,D] to D.
- Node F receives a RREQ [S,..X] for some node D, If it knows route [F,...,D], F returns RREP [S,..,X,F,...,D], Otherwise, F broadcasts RREQ [S,..X] to neighbors

#### File mainnode.py
The files does the works the same as for flooding. Added functions include changing of routes after every two packets(change line 96 to change this). After creating a new graph a signal is sent to nodes in response to which they read the graph again stored in the pickle file.
#### File nodes.py
The files performs the same functions as it did for flooding as well as the required functionality for route discovery, route reply, data packets. 

## How to run
- Run the graphgenerator.py file. python graphgenerator.py
- Run the mainnode.py file. python mainnode.py
